<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Fares Management</title>
<link href="lib/leaflet.css" orig="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" rel="stylesheet">
<link href="lib/jquery-ui.min.css" rel="stylesheet">
<link href="lib/tabulator.min.css" rel="stylesheet">
<link href="lib/bootstrap.v4.0.0.min.css" crossorigin="anonymous" alt="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet"><!-- Put the CSSs first and JSs next -->

<script src="lib/jquery-3.3.1.min.js" type="text/javascript">
</script>
<script src="lib/jquery-ui.min.js" type="text/javascript">
</script>
<script src="lib/leaflet.js">
</script>
<script src="lib/tabulator.js" type="text/javascript">
</script>
<script src="lib/popper.v1.12.9.min.js" crossorigin="anonymous" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" alt="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js">
</script>
<script src="lib/bootstrap.v4.0.0.min.js" crossorigin="anonymous" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" alt="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js">
</script>
<script src="lib/papaparse.min.js" type="text/javascript"></script>
<style>
body, textarea, .leaflet-container {
	font-family: "Ubuntu", "Open Sans", "Helvetica", "Arial";
}
body {
		padding-top: 60px;
}
#allcontainer {
	width: 100%;
}
#leftcontainer {
	float:left; width:55%;
}

#rightcontainer {
	float:right; width: 45%;
	border-left: 1px solid #ccc;
	padding-left: 50px;
}

#map, #fare-attributes-table {
	width: 98%;
}
#map {
	height: 400px;
}
#fare-rules-table {
	height: 400px;
}
#fare-attributes-table {
	max-height: 400px;
}
.ui-autocomplete {
	font-size: 0.8em;
	max-height: 100px;
	overflow-y: auto;
	/* prevent horizontal scrollbar */
	overflow-x: hidden;
}
h3,h4 { margin-top : 0.5em; line-height: 1.5em; }
small { line-height: 0.2em; }

.leaflet-popup-content-wrapper {
	background: #000000a1;
	color: #fff;
	border-radius: 8px;
}
.leaflet-popup-tip {
	background: #000000a1;
}
/*.leaflet-tooltip {} */
.leaflet-popup-content {
	margin-top: 10px;
}
/*
#fare-rules-table .tabulator-frozen-left {
	background-color: #ddd!important;
	color: black;
}
*/
.tabulator {
	background-color: #fff;
}
#trackChanges {
	width:100%;
}
.ui-accordion-content a {
	text-decoration: underline;
}


</style>
	   
</head>
<body>
<script src="js/navbar.js"></script>
<h2>Fares</h2>
<div class="container">

<!-- Tabs Menu -->
<ul class="nav nav-tabs" id="myTab" role="tablist">
<li class="nav-item">
<a class="nav-link active" data-toggle="tab" role="tab" aria-controls="profile" aria-selected="false" id="fare-rules-tab" href="#fare-rules">Fare Rules</a>
</li>
<li class="nav-item">
<a class="nav-link" id="attributes-tab" data-toggle="tab" href="#attributes" role="tab" aria-controls="attributes" aria-selected="true">Fare Attributes</a>
</li>
</ul>
<div class="tab-content" id="myTabContent">

<!-- FARE RULES -->
<div class="tab-pane fade show active" role="tabpanel" aria-labelledby="fare-rules-tab" id="fare-rules">
<h3>Fare Rules</h3>
<div id="fare-rules-table"></div><br>
<p align="center">Changes: <button class="btn-warning btn-sm" id="rules-undo">Undo</button> | <button class="btn-info btn-sm" id="rules-redo" >Redo</button> | <button id="saveFareRules" class="btn-success btn-lg">Save Fare Rules</button>
</p>

<div id="accordion">
<h3>Instructions</h3>
<div>
The zone_id's defined in <a href="stop.html">Stops Management</a> are arranged here in a 2-D matrix. <br>You can change the fares by clicking on them. <br>The fare's values can be set in the Fare Attributes tab.
<br>Reference: <a href="https://developers.google.com/transit/gtfs/reference/#fare_rulestxt" target="_blank">GTFS fare rules specs</a>
<br>Use the Undo button to undo changes. To revert to the last saved version, simply reload this page.

</div>
</div><!-- Accordion over -->
<p></p>




<!-- we probably won't be adding / deleting any rows here
<p>Add Fare rules for <input size="6" id="stopRule"> <button id="addRule">Add</button>
-->

</div>

<!-- FARE ATTRIBUTES -->
<div class="tab-pane fade" role="tabpanel" aria-labelledby="attributes-tab" id="attributes">
<div id="leftcontainer">
<h3>Fare Attributes</h3>
<div id="fare-attributes-table"></div>

<p align="center"><br>
Changes: <button class="btn-warning btn-sm" id="attributes-undo">Undo</button> | <button class="btn-info btn-sm" id="attributes-redo" >Redo</button>
</p>
<p><small>Instructions: Each price bracket to have an entry here. See <a href="https://developers.google.com/transit/gtfs/reference/#fare_attributestxt" target="_blank" >GTFS reference</a> for more info.</small></p>
</div>

<div class="container" id="rightcontainer">
<h4>Add/Edit a Fare Attribute</h4>

<p>Pick or create a fare_id: <input autocapitalize="characters" id='targetFareid' placeholder='fare id' size="5"></p>
<p>Set a price: <input id='price' type="number" style="width:50px;"> INR => <button id="addEditFare" class="btn-primary btn-sm">Add or Edit Fare</button></p>
<p>Or, <button id="deleteFare" class="btn-danger btn-sm">Delete Fare</button></p>
<p><button id="saveFareAttributes" class="btn-success btn-lg">Save Fare Attributes</button></p>

</div>
</div>


</div>

<div style="clear:both"></div>
<div id="logaccordion">
<h3>Changes Log</h3>
<div>
<p><textarea id="trackChanges" rows=10 cols="40"></textarea></p>
</div>
</div><!-- Accordion over -->

</div>
<br><br><br>
<script src="js/commonfuncs.js" type="text/javascript"></script>
<script src="js/fares.js" type="text/javascript"></script>
</body>
</html>