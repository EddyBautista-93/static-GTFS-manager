<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>GTFS Manager : Stops</title>

    
   <!-- Fontfaces CSS-->
   <link href="css/font-face.css" rel="stylesheet" media="all">
   <link href="vendor/font-awesome-5/css/all.min.css" rel="stylesheet" media="all">

   <!-- Bootstrap CSS-->
   <link href="vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

	<!-- Leaflet Maps -->
	<link href="lib/leaflet.css" orig="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" rel="stylesheet"/>
	<link href="lib/easy-button.css" alt="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css" rel="stylesheet"/>
	<link href="lib/L.Control.ZoomBox.css" rel="stylesheet"/>
    <link href="vendor/leaflet-control-geocoder-1.8.2/Control.Geocoder.css" rel="stylesheet" />
	
    <!-- Vendor CSS-->
   <link href="vendor/animsition/animsition.min.css" rel="stylesheet" media="all">
   <link href="vendor/wow/animate.css" rel="stylesheet" media="all">
   <link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
   <link href="vendor/slick/slick.css" rel="stylesheet" media="all">
   <link href="vendor/select2/css/select2.min.css" rel="stylesheet" media="all">
   <link href="vendor/select2/css/select2-bootstrap4.min.css" rel="stylesheet" media="all">
   <link href="vendor/toast-0.7.1/toast.min.css" rel="stylesheet" media="all">

   <link href="vendor/tabulator-4.2.7/css/bootstrap/tabulator_bootstrap4.min.css" rel="stylesheet" media="all">
   <script src="vendor/tabulator-4.2.7/js/tabulator.min.js"></script>

    <!-- Main CSS-->
    <link href="css/theme.css" rel="stylesheet" media="all">
    <!-- Put the CSSs first and JSs next -->
	<style>		
			
			#map, #stops-table {
			width: 100%;
			}
			#map {
			height: 500px;
			}
			#stops-table {
			height: 400px;
			}
			
			/* leaflet stop markers */
			.stop-divicon {
				border-radius: 50%;
				color: white;
				padding-top: 1px;
				position: absolute;
				text-align: center;
				overflow: hidden;
				box-shadow:0px 0px 5px black; /*looks 3D! no need of a border*/
				background-color: rgba(0, 0, 150, 0.7);
				font-size: 10px;
				font-weight: 600;
			}
			
			</style>
</head>

<body>       
                <div class="page-wrapper">
                        <!-- HEADER DESKTOP-->
                    <header class="header-desktop3 d-none d-lg-block">
                        <div class="section__content section__content--p35">
                            <div class="header3-wrap">
                                <div class="header__logo">
                                    <a href="#">
                                        <img src="extra_files/GTFS.png" width="52" height="170"  alt="GTFS Manager" />
                                    </a>
                                </div>
                                <div class="header__navbar">
                                    <ul class="list-unstyled">                            
                                        <li>
                                            <a href="index.html">
                                                <i class="fas fa-home"></i>
                                                <span class="bot-line"></span>Home</a>
                                        </li>                            
                                        <li class="has-sub">
                                            <a href="#">
                                                <i class="fas fa-bus"></i>
                                                <span class="bot-line"></span>GTFS</a>
                                            <ul class="header3-sub-list list-unstyled">
                                                <li>
                                                    <a href="agency.html"><i class="fas fa-building"></i>Agency</a>
                                                </li>
                                                <li class="active">
                                                    <a href="stops.html"><i class="fas fa-map-marker-alt"></i>Stops</a>
                                                </li>
                                                <li>
                                                    <a href="routes.html"><i class="fas fa-road"></i>Routes</a>
                                                </li>
                                                <li>
                                                    <a href="calendar.html"><i class="fas fa-calendar"></i>Calendar</a>
                                                </li>
                                                <li>
                                                    <a href="tripstimings.html"><i class="fas fa-stopwatch"></i>Trips, Stop_times</a>
                                                </li>
                                                <li>
                                                    <a href="frequencies.html"><i class="fas fa-wave-square"></i>Frequencies</a>
                                                </li>
                                                <li>
                                                    <a href="fares.html"><i class="fas fa-dollar-sign"></i>Fares</a>
                                                </li>
                                                <li>
                                                    <a href="translations.html"><i class="fas fa-language"></i>Translations</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="has-sub">
                                            <a href="#">
                                                <i class="fas fa-tools"></i>
                                                <span class="bot-line"></span>Tools</a>
                                            <ul class="header3-sub-list list-unstyled">
                                                <li class="active">
                                                    <a href="sequence.html"><i class="fas fa-align-justify"></i>Default Route Sequence</a>
                                                </li>
                                                <li>
                                                    <a href="renameID.html"><i class="fas fa-pen"></i>Rename ID</a>
                                                </li>
                                                <li>
                                                    <a href="deleteID.html"><i class="fas fa-trash"></i>Delete ID</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="has-sub">
                                            <a href="#">
                                                <i class="fas fa-tools"></i>
                                                <span class="bot-line"></span>Data</a>
                                            <ul class="header3-sub-list list-unstyled">
                                               <li>
                                                    <a href="kmrl.html"><i class="fas fa-file-import"></i>Import KMRL format</a>
                                                </li>
                                                <li>
                                                    <a href="hmrl.html"><i class="fas fa-file-import"></i>Import HRML format</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                                <div class="">
                                        <input id="password" class="form-control mr-sm-2" type="text" placeholder="pw for edits" style="width:200px;" id="password">
                                </div>
                            </div>
                        </div>
                    </header>
                    <!-- END HEADER DESKTOP-->
                        <!-- MAIN CONTENT-->
                        <div class="page-content--bgf7">
                    <div class="section__content section__content--p30">
                        <div class="container">
							<div class="row">
								<div class="col-md-12">
									<div class="accordion" id="accordionExample">
										<div class="card">
										  <div class="card-header" id="headingOne">
											<h2 class="mb-0">
											  <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
												<i class="fas fa-angle-right"></i> Instructions
											  </button>
											</h2>
										  </div>									  
										  <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
											<div class="card-body">
												<b>List tab:</b>
												<ul>
												<li>Click on a stop id or name for a quick edit.</li>
												<li>To select a stop in the table, click on the left side handlebar. The stop will get highlighted on the map as well.</li>
												<li>You can also click on a stop on the map to higlight its row in the table.</li>
												<li>Looking for a particular stop? You can filter the stops table by typing into the filter inputs on the column headers and pressing [Enter] key.</li>
												<li>Apply the table's filters on the map view also, by clicking the filter button on map (funnel icon).</li>
												<li>Revert the map to showing all stops by clicking the Home icon.</li>
												</ul>
												
												<b>Add/Edit tab:</b>
												<ul>
												<li>Go to the Add/Edit tab to edit the stops data.</li>
												<li>Click a stop on the map, and then the fields should auto-populate with the existing values.</li>
												<li>To change the stop's location, you can click at the new location on the map. You should see a red dot, and the lat-long values will change by themselves.</li>
												<li>Press "Click to Add/Update" to update the stops table with updated data.</li>
												<li>Similarly you can add a new stop by typing in a unique stop_id that has not already been used and following the same process.</li>
												
												<li><b>zone_id</b> field is used in <a href="fares.html">Fares Section</a>. In the station pairs model, this is typically same as stop_id.</li>
												</ul>
												
												<p>More info: <a href="https://developers.google.com/transit/gtfs/reference/#stopstxt" target="_blank">GTFS stops specs</a></p>
											</div>
										  </div>
										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									<div class="card">
										<div class="card-header">
											<strong class="card-title mb-3">Stops</strong>
										</div>
										<div class="card-body">
											<ul class="nav nav-tabs" id="myTab" role="tablist">
                                                <li class="nav-item">
                                                    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">List</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" id="edit-tab" data-toggle="tab" href="#edit" role="tab" aria-controls="eit" aria-selected="false">Add / Edit</a>
                                                </li>                                                
											</ul>
											<div class="tab-content pl-3 p-1" id="myTabContent">
                                                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                                                    <div id="stops-table"></div>
													<br>
													<p><small>Note: Auto-zooming-in or out is disabled because it was disorienting users while mapping. You can use +/- keys after clicking once on the map to quckly zoom.</small></p>
                                                </div>
                                                <div class="tab-pane fade" id="edit" role="tabpanel" aria-labelledby="edit-tab">													
                                                    <h3>Add a new stop, or edit an existing one</h3>
                                                    
                                                            <div class="row form-group">
                                                                <div class="col col-md-3">
                                                                    <label for="targetStopid" class="form-control-label">Pick a stop_id</label>
                                                                </div>
                                                                <div class="col-12 col-md-9">
                                                                    <select class="form-control" id='targetStopid'></select>
                                                                </div>
                                                            </div>
                                                            <div class="row form-group">
                                                                <div class="col col-md-3">
                                                                    <label for="stop_name" class="form-control-label">Stop name</label>
                                                                </div>
                                                                <div class="col-12 col-md-9">
                                                                        <input id='stop_name' placeholder="full name" type="text" class="form-control">
                                                                </div>
                                                            </div>
                                                            <div class="row form-group">
                                                                <div class="col col-md-3">
                                                                    <label for="wheelchair" class="form-control-label">Wheelchair boarding</label>
                                                                </div>
                                                                <div class="col-12 col-md-9">
                                                                    <select id="wheelchair" name="wheelchair" class="form-control">
                                                                        <option selected value="0">No</option>
                                                                        <option selected value="1">Yes</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="row form-group">
                                                                <div class="col col-md-3">
                                                                    <label for="feed_version" class="form-control-label">Location</label>
                                                                </div>
                                                                <div class="col-12 col-md-9">
                                                                    <input id="newlatlng" placeholder="Lat,Long" size="10" type="text" class="form-control">
                                                                </div>
                                                            </div>
                                                            <div class="row form-group">
                                                                <div class="col col-md-3">
                                                                    <label for="feed_version" class="form-control-label">Zone ID</label>
                                                                </div>
                                                                <div class="col-12 col-md-9">
                                                                        <input id='zone_id' placeholder="usually same as stop_id" title="used for fare rules; usually same as stop_id" type="text" class="form-control">
                                                                </div>
                                                            </div>													
                                                            <p><button class="btn-primary btn-lg" onclick="updateTable()" type="button">Click to add/update</button></p>                                                       
                                                    </div>
                                                </div>                                               
                                            </div>
										<div class="card-footer">
											<p>Once all edits are done, <button class="btn btn-success" id="savetable" name="savetable">Save Stops to DB</button></p>
											<p><small id="stopSaveStatus"></small></p>
                                        </div>
                                    </div>
                                </div>
                            </div>							
							<div class="row">
								<div class="col-md-12">
                                    <div id="map"></div>
                                    <div class="card">
                                        <div class="card-body">
                                        <p>Got another data source of point locations?<br>
                                            <input type="file" id="databank" name="databank" class="btn btn-sm btn-outline-secondary" accept=".csv">
                                            <button onclick="databank()">Load databank</button></p>
                                            <small>Will appear as small brown points. The CSV databank file needs to have at least a stop_name, stop_lat and stop_lon column.</small>
                                        </div>
                                    </div>
								</div>
							</div>	
							<div class="row">
								<div class="col-md-12">
										<div id="logaccordion" class="container" style="visibility: hidden;">
												<h3>Changes Log</h3>
												
												<p><textarea id="trackChanges" rows=10></textarea>
												</p>
												
												</div>
								</div>
							</div>
                        </div>
                    </div>
                </div>
                <!-- END MAIN CONTENT-->
                <!-- END PAGE CONTAINER-->
            </div>
    
        </div>
    
         <!-- Jquery JS-->
         <script src="vendor/jquery-3.2.1.min.js"></script>
         <!-- Bootstrap JS-->
         <script src="vendor/bootstrap-4.1/popper.min.js"></script>
         <script src="vendor/bootstrap-4.1/bootstrap.min.js"></script>
        
		<!-- Leaflet Maps -->
		
		<script src="lib/leaflet.js"></script>
		<script src="lib/easy-button.js" alt="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
		<script src="lib/papaparse.min.js" type="text/javascript"></script>
        <script src="lib/L.Control.ZoomBox.min.js" type="text/javascript"></script>
        <script src="vendor/leaflet-control-geocoder-1.8.2/Control.Geocoder.js"></script>

        <!-- Vendor JS       -->
        <script src="vendor/animsition/animsition.min.js"></script>
        <script src="vendor/circle-progress/circle-progress.min.js"></script>
        <script src="vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
        <script src="vendor/chartjs/Chart.bundle.min.js"></script>
        <script src="vendor/select2/js/select2.min.js"></script>
        <script src="js/Select2EditorTimezone.js"></script>		
        <script src="vendor/toast-0.7.1/toast.min.js"></script>
        <!-- Main JS-->
        <script src="js/main.js"></script>
    
    

<script src="config/settings.js" type="text/javascript"></script>
<script src="js/commonfuncs.js" type="text/javascript"></script>
<script src="js/stops.js"></script>

</body>  
</html>